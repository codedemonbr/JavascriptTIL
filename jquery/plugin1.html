<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Plugin #01</title>
        <link rel="stylesheet" href="css/estilo.css" />
        <script src="js/jquery.js"></script>
    </head>

    <body class="conteudo exercicio">
        <h1>Plugin #01</h1>
        <div>
            {{ 1 + 2 }} Texto 1
        </div>

        <script>
            (function ($) {
                $.fn.interpretar = function () {
                    const retirarChaves = (s) => s.substring(2, s.length - 2);
                    const conteudo = $(this).html();
                    const expressoesComChaves = conteudo.match(/\{\{.+\}\}/g);
                    const expressoes = expressoesComChaves.map(retirarChaves);
                    const resultados = expressoes.map((e) => eval(e));

                    let conteudoFinal = conteudo;

                    for (
                        let index = 0;
                        index < expressoesComChaves.length;
                        index++
                    ) {
                        conteudoFinal = conteudoFinal.replace(
                            expressoesComChaves[index],
                            resultados[index]
                        );
                    }
                    $(this).html(conteudoFinal);
                    return this;
                };
            })(jQuery);

            $('div').interpretar();
        </script>
    </body>
</html>
